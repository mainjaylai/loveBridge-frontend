<wxs module="utils" src="../utils.wxs" />
<view class="main">
  <!-- 顶部导航 -->
  <van-tabs class="tab-container" active="{{ orderTypeId }}" bind:click="onTabClick" sticky>
    <van-tab title="全部"></van-tab>
    <van-tab title="待付款"></van-tab>
    <van-tab title="已付款"></van-tab>
    <van-tab title="待评价"></van-tab>
    <van-tab title="售后"></van-tab>
  </van-tabs>
  <scroll-view class="scrollarea" scroll-y type="list">
    <!-- 订单列表 -->
    <view class="orders-container">
      <block wx:for="{{payments}}" wx:key="index">
        <view class="base-card-new order-card" wx:if="{{orderTypeId === 0 || item.orderTypeId === orderTypeId}}" bindtap="navigateToOrder" data-id="{{item.id}}" data-ordertypeid="{{item.orderTypeId}}">
          <view class="title-row">
            <text>订单号：{{item.outTradeNo}}</text>
            <view class="status-label status-color-{{item.status}}">
              {{ORDER_STATUS_TO_LABEL[item.status]}}
            </view>
          </view>
          <view class="horizontal-divider"></view>
          <view class="activity-row">
            <image class="image" src="{{item.activity.cover}}" mode="aspectFill"></image>
            <view class="text-container">
              <view style="display: flex; justify-content: space-between;">
                <view class="title">{{item.activity.title}}</view>
                <view class="money">
                  <text class="yuan">¥</text>
                  <text class="amount">{{item.finalAmount/100}}</text>
                </view>
              </view>
              <view class="date">
                <view>开始时间：{{item.tourSchedule.startDate}}</view>
                <view>结束时间：{{item.tourSchedule.endDate}}</view>
              </view>
            </view>
          </view>
        </view>
      </block>
    </view>
    <!-- 空提示 -->
    <view wx:if="{{orderTypeId === 0 && payments.length === 0 || orderTypeId !== 0 && !utils.includesObjKey(payments, 'orderTypeId', orderTypeId)}}" class="null">
      <empty-page></empty-page>
    </view>
  </scroll-view>
</view>